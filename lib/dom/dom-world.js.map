{"version":3,"file":"dom-world.js","sourceRoot":"","sources":["../../src/dom/dom-world.ts"],"names":[],"mappings":"AAEA,MAAM,WAAW,GAAoB,EAAE,CAAC;AACxC,IAAI,aAAa,GAAG,KAAK,CAAC;AAC1B,IAAI,KAAK,GAAkB,IAAI,CAAC;AAEhC,MAAM,UAAU,aAAa,CAAC,EAAiB;IAC7C,WAAW,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;IAErB,IAAI,CAAC,aAAa,EAAE,CAAC;QACnB,SAAS,EAAE,CAAC;IACd,CAAC;AACH,CAAC;AAED,MAAM,UAAU,gBAAgB,CAAC,EAAiB;IAChD,MAAM,KAAK,GAAG,WAAW,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;IACtC,IAAI,KAAK,KAAK,CAAC,CAAC,EAAE,CAAC;QACjB,WAAW,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;IAC/B,CAAC;IAED,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE,CAAC;QAC7B,QAAQ,EAAE,CAAC;IACb,CAAC;AACH,CAAC;AAED,SAAS,SAAS;IAChB,aAAa,GAAG,IAAI,CAAC;IACrB,IAAI,QAAQ,GAAG,WAAW,CAAC,GAAG,EAAE,CAAC;IAEjC,SAAS,IAAI,CAAC,GAAW;QACvB,MAAM,KAAK,GAAG,CAAC,GAAG,GAAG,QAAQ,CAAC,GAAG,IAAI,CAAC;QACtC,QAAQ,GAAG,GAAG,CAAC;QAEf,KAAK,MAAM,GAAG,IAAI,WAAW,EAAE,CAAC;YAC9B,GAAG,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAC3B,CAAC;QAED,IAAI,aAAa,EAAE,CAAC;YAClB,KAAK,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC;QACtC,CAAC;IACH,CAAC;IAED,KAAK,GAAG,qBAAqB,CAAC,IAAI,CAAC,CAAC;AACtC,CAAC;AAED,SAAS,QAAQ;IACf,IAAI,KAAK,KAAK,IAAI,EAAE,CAAC;QACnB,oBAAoB,CAAC,KAAK,CAAC,CAAC;QAC5B,KAAK,GAAG,IAAI,CAAC;IACf,CAAC;IACD,aAAa,GAAG,KAAK,CAAC;AACxB,CAAC","sourcesContent":["import { DomGameObject } from \"./dom-game-object\";\n\nconst rootObjects: DomGameObject[] = [];\nlet isLoopRunning = false;\nlet rafId: number | null = null;\n\nexport function addRootObject(go: DomGameObject) {\n  rootObjects.push(go);\n\n  if (!isLoopRunning) {\n    startLoop();\n  }\n}\n\nexport function removeRootObject(go: DomGameObject) {\n  const index = rootObjects.indexOf(go);\n  if (index !== -1) {\n    rootObjects.splice(index, 1);\n  }\n\n  if (rootObjects.length === 0) {\n    stopLoop();\n  }\n}\n\nfunction startLoop() {\n  isLoopRunning = true;\n  let lastTime = performance.now();\n\n  function loop(now: number) {\n    const delta = (now - lastTime) / 1000;\n    lastTime = now;\n\n    for (const obj of rootObjects) {\n      obj._engineUpdate(delta);\n    }\n\n    if (isLoopRunning) {\n      rafId = requestAnimationFrame(loop);\n    }\n  }\n\n  rafId = requestAnimationFrame(loop);\n}\n\nfunction stopLoop() {\n  if (rafId !== null) {\n    cancelAnimationFrame(rafId);\n    rafId = null;\n  }\n  isLoopRunning = false;\n}\n"]}