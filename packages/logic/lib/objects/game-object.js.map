{"version":3,"file":"game-object.js","sourceRoot":"","sources":["../../src/objects/game-object.ts"],"names":[],"mappings":"AAAA,OAAO,EAAmB,UAAU,EAAE,IAAI,EAAE,MAAM,kBAAkB,CAAA;AAMpE,MAAM,OAAO,UAAU;IACrB,QAAQ,CAAmB;IAC3B,SAAS,GAAiB,EAAE,CAAA;IAElB,GAAG,CAAS;IACZ,KAAK,CAAkB;IAEjC,YAAY,OAA0B;QACpC,IAAI,CAAC,QAAQ,GAAG,OAAO,CAAA;IACzB,CAAC;IAED,IAAI,IAAI,CAAC,IAAqB;QAC5B,IAAI,IAAI,CAAC,KAAK;YAAE,MAAM,IAAI,KAAK,CAAC,iCAAiC,CAAC,CAAA;QAElE,MAAM,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,CAAA;QACxB,IAAI,CAAC,aAAa,CAAC,EAAE,EAAE,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAA;QAE1C,IAAI,CAAC,GAAG,GAAG,EAAE,CAAA;QACb,IAAI,CAAC,KAAK,GAAG,IAAI,CAAA;QAEjB,KAAK,MAAM,KAAK,IAAI,IAAI,CAAC,SAAS,EAAE,CAAC;YACnC,IAAI,CAAC,KAAK,CAAC,KAAK;gBAAE,KAAK,CAAC,IAAI,GAAG,IAAI,CAAA;YACnC,IAAI,CAAC,MAAM,CAAC,EAAE,EAAE,KAAK,CAAC,GAAI,CAAC,CAAA;QAC7B,CAAC;IACH,CAAC;IAED,GAAG,CAAC,GAAG,QAAsB;QAC3B,KAAK,MAAM,KAAK,IAAI,QAAQ,EAAE,CAAC;YAC7B,IAAI,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,GAAG,KAAK,SAAS,EAAE,CAAC;gBACzC,IAAI,CAAC,KAAK,CAAC,KAAK;oBAAE,KAAK,CAAC,IAAI,GAAG,IAAI,CAAC,KAAK,CAAA;gBACzC,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,GAAI,CAAC,CAAA;YACzC,CAAC;YACD,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;QAC5B,CAAC;IACH,CAAC;IAED,OAAO;QACL,IAAI,CAAC,IAAI,CAAC,KAAK,IAAI,IAAI,CAAC,GAAG,KAAK,SAAS;YAAE,MAAM,IAAI,KAAK,CAAC,6BAA6B,CAAC,CAAA;QAEzF,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAA;QAC3B,IAAI,CAAC,KAAK,GAAG,SAAS,CAAA;QACtB,IAAI,CAAC,GAAG,GAAG,SAAS,CAAA;IACtB,CAAC;CACF;AAED,MAAM,OAAO,UAAW,SAAQ,UAAU;IACxC,YAAY,IAAqB;QAC/B,KAAK,CAAC,EAAE,IAAI,EAAE,UAAU,CAAC,SAAS,EAAE,CAAC,CAAA;QACrC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAA;QACf,IAAI,CAAC,KAAK,GAAG,IAAI,CAAA;IACnB,CAAC;CACF","sourcesContent":["import { ObjectStateTree, ObjectType, ROOT } from '@kiwiengine/core'\n\nexport type GameObjectOptions = {\n  type: ObjectType\n}\n\nexport class GameObject {\n  #options: GameObjectOptions\n  #children: GameObject[] = []\n\n  protected _id?: number\n  protected _tree?: ObjectStateTree\n\n  constructor(options: GameObjectOptions) {\n    this.#options = options\n  }\n\n  set tree(tree: ObjectStateTree) {\n    if (this._tree) throw new Error('GameObject is already in a tree')\n\n    const id = tree.create()\n    tree.setObjectType(id, this.#options.type)\n\n    this._id = id\n    this._tree = tree\n\n    for (const child of this.#children) {\n      if (!child._tree) child.tree = tree\n      tree.insert(id, child._id!)\n    }\n  }\n\n  add(...children: GameObject[]) {\n    for (const child of children) {\n      if (this._tree && this._id !== undefined) {\n        if (!child._tree) child.tree = this._tree\n        this._tree.insert(this._id, child._id!)\n      }\n      this.#children.push(child)\n    }\n  }\n\n  destroy() {\n    if (!this._tree || this._id === undefined) throw new Error('GameObject is not in a tree')\n\n    this._tree.remove(this._id)\n    this._tree = undefined\n    this._id = undefined\n  }\n}\n\nexport class RootObject extends GameObject {\n  constructor(tree: ObjectStateTree) {\n    super({ type: ObjectType.CONTAINER })\n    this._id = ROOT\n    this._tree = tree\n  }\n}\n"]}